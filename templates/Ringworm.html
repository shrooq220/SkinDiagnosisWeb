<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='Main.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
    <title>DermaLens â€¢ Result</title>

    <style>
        :root {
            --brand-brown: #a18664;
        }

        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ù…ÙˆØ­Ø¯Ø© Ù„ØªÙ…ÙŠÙŠØ² Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù†Ø´Ø·Ø© (Ù„Ù„ØªÙ†Ø§Ø³Ù‚) */
        .navigation .navLinks li a:hover,
        .navigation .navLinks li.active-page>a,
        .navigation .navLinks li.profile-menu.active-page>a {
            color: var(--brand-brown);
            font-weight: 600;
        }

        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯Ø© */
        .profile-menu {
            position: relative;
        }

        .profile-menu .dropdown {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background-color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 10px 0;
            min-width: 180px;
            z-index: 10;
        }

        .profile-menu.active .dropdown {
            display: block;
        }

        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø£Ø®Ø±Ù‰ Ù„Ù„ØµÙØ­Ø© */
        .site-footer {
            /* Ù„ØªØ«Ø¨ÙŠØª Ù…ÙˆØ¶Ø¹Ù‡ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¹Ø±Ø¶ */
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 1000;
        }
    </style>
</head>

<body>

    <div id="details-hw" class="header-wrapper">
        <header>
            <nav class="navigation container">
                <div class="logo">
                    <a href="{{ url_for('diagnosis') }}">DermaLens</a>
                </div>

                <ul class="navLinks">
                    <li><a href="{{ url_for('history') }}" data-key="history">History</a></li>
                    <li><a href="{{ url_for('community') }}" data-key="community">Community</a></li>
                    <li><a href="{{ url_for('about') }}" data-key="about">About</a></li>

                    <li class="profile-menu" id="profile-toggle">
                        <a href="#" title="Account Menu" id="profileDropdownToggle"><i class="fa-solid fa-circle-user"></i></a>

                        <div class="dropdown">
                            <a href="#" id="profileLink" data-key="profile">Profile</a>

                            <div class="separator"></div>

                            <div class="lang-options">
                                <a onclick="switchLang('ar')">Ø¹Ø±Ø¨ÙŠ</a>
                                <a onclick="switchLang('en')">English</a>
                            </div>

                            <div class="separator" id="authSeparator"></div>

                            <a href="#" data-key="auth" id="authLink">Log Out</a>
                        </div>
                    </li>
                </ul>
            </nav>
        </header>

        <div class="illness-hero">
            <p data-key="youhave">You Have a <span class="percentage">{{ confidence }}%</span>
                <br>Chance that you have
            </p>
            <h1 data-key="diesase" id="diseaseNameDisplay">{{ pred_name }}</h1>
            <p class="description" data-key="description">A common skin condition that causes dry, itchy, and inflamed patches of skin. It's also known as atopic dermatitis and often appears in childhood but can occur at any age</p>
        </div>

    </div>

    <div class="video-container">
        <video id="video" class="video" data-key="video_src" autoplay muted loop></video>
    </div>

    <section class="details-sec">

        <div class="illness-card symptoms-card">
            <h3 data-key="Symptoms"><i class="fas fa-stethoscope illness-icon"></i>Symptoms</h3>
            <ul class="symptoms-list">
                <li class="symptom-item" data-key="s1">Dry, itchy, and inflamed skin patches</li>
                <li class="symptom-item" data-key="s2">Red or brown-colored patches</li>
                <li class="symptom-item" data-key="s3">Rough, cracked, or scaly skin</li>
                <li class="symptom-item" data-key="s4">Small, raised bumps that may leak fluid</li>
                <li class="symptom-item" data-key="s5">Thickened skin from scratching</li>
            </ul>
        </div>

        <div class="illness-card image-card">
            <img src="{{ url_for('static', filename='Pics/images.jpg') }}" alt="Ringworm body locations">
            <div class="image-overlay">
                <p data-key="picalt1">Common areas where Ringworm appears</p>
            </div>
        </div>

    </section>

    <section class="details-sec">
        <div class="illness-card image-card">
            <img src="{{ url_for('static', filename='Pics/skin-disease-human-health-problem-600nw-2530985179.webp') }}" alt="Ringworm symptoms">
            <div class="image-overlay">
                <p data-key="picalt2">Visual examples of Ringworm symptoms</p>
            </div>
        </div>

        <div class="illness-card locations-card">
            <h3 data-key="appears"><i class="fas fa-map-marker-alt illness-icon"></i>It can appears in:</h3>
            <ul class="locations-list">
                <li class="location-item" data-key="a1">Face and cheeks</li>
                <li class="location-item" data-key="a2">Hands and wrists</li>
                <li class="location-item" data-key="a3">Elbows and knees</li>
                <li class="location-item" data-key="a4">Neck and ankles</li>
                <li class="location-item" data-key="a5">Around the eyes</li>
            </ul>
        </div>
    </section>

    <footer class="site-footer">
        <div class="container">Dermalens. Copyright DERMALENS. All Rights Reserved</div>
    </footer>

</body>

<script>
    // Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…ÙˆØ­Ø¯Ø© ÙˆØ§Ù„Ù…ÙˆØ¬Ù‡Ø© Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    function logout() {
        localStorage.removeItem('token');
        localStorage.removeItem('loggedIn');
        const lang = localStorage.getItem('lang') || 'en';
        alert(lang === 'ar' ? 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­.' : 'Logged out successfully.');
        window.location.href = "{{ url_for('login') }}"; // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    }

    const video = document.getElementById('video');
    video.parentElement.addEventListener('mouseenter', () => video.setAttribute('controls', ''));
    video.parentElement.addEventListener('mouseleave', () => video.removeAttribute('controls'));

    /* Change the language */
    const translations = {
        ar: {
            history: "Ø§Ù„Ø³Ø¬Ù„",
            community: "Ø§Ù„Ù…Ø¬ØªÙ…Ø¹",
            about: "Ø¹Ù†Ø§",
            profile: "Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ", 
            login: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„", 
            logout: "ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬", 
            youhave: "Ù„Ø¯ÙŠÙƒ Ø§Ø­ØªÙ…Ø§Ù„ Ø¨Ù†Ø³Ø¨Ø© {percentage}<br>Ù„Ù„Ø¥ØµØ§Ø¨Ø© Ø¨Ù€",
            diesase: "Ø³Ø¹ÙØ©/ÙØ·Ø§Ø± Ø¬Ù„Ø¯ÙŠ (Ringworm)", // ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø³Ø¹ÙØ©/Ø§Ù„ÙØ·Ø§Ø± Ø§Ù„Ø¬Ù„Ø¯ÙŠ
            description: "Ø¹Ø¯ÙˆÙ‰ ÙØ·Ø±ÙŠØ© Ø´Ø§Ø¦Ø¹Ø© ØªØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ø´ÙƒÙ„ Ø·ÙØ­ Ø¬Ù„Ø¯ÙŠ Ø£Ø­Ù…Ø± ÙˆØ­Ø§Ùƒ ÙˆÙ…ØªÙ‚Ø´Ø± Ø¹Ù„Ù‰ Ø´ÙƒÙ„ Ø­Ù„Ù‚Ø© (Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ø±ÙŠ). Ø±ØºÙ… Ø§Ø³Ù…Ù‡Ø§ØŒ Ù„Ø§ ØªØ³Ø¨Ø¨Ù‡Ø§ Ø¯ÙˆØ¯Ø©.",
            Symptoms: "Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶",
            s1: "Ø·ÙØ­ Ø¬Ù„Ø¯ÙŠ Ø¯Ø§Ø¦Ø±ÙŠ Ø£Ùˆ Ø­Ù„Ù‚ÙŠ Ø§Ù„Ø´ÙƒÙ„",
            s2: "Ø­ÙˆØ§Ù Ù…Ø±ØªÙØ¹Ø© ÙˆÙ…ØªÙ‚Ø´Ø±Ø©",
            s3: "Ø­ÙƒØ© ÙÙŠ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…ØµØ§Ø¨Ø©",
            s4: "ØªÙ‚Ø´Ø± Ø£Ùˆ ØªØ´Ù‚Ù‚ Ø§Ù„Ø¬Ù„Ø¯",
            s5: "Ø¬Ù„Ø¯ Ø£Ø­Ù…Ø± ÙˆÙ…ØªÙ‡ÙŠØ¬",
            picalt1: "Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„Ø³Ø¹ÙØ©",
            picalt2: "Ø£Ù…Ø«Ù„Ø© Ø¨ØµØ±ÙŠØ© Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„Ø³Ø¹ÙØ©",
            appears: "Ù‚Ø¯ ØªØ¸Ù‡Ø± ÙÙŠ:",
            a1: "ÙØ±ÙˆØ© Ø§Ù„Ø±Ø£Ø³ (Tinea Capitis)",
            a2: "Ø§Ù„Ù‚Ø¯Ù…ÙŠÙ† (Ù‚Ø¯Ù… Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠ)",
            a3: "Ø§Ù„ÙØ®Ø°ÙŠÙ† (Ø­ÙƒØ© Ø¬ÙˆÙƒ)",
            a4: "Ø§Ù„Ø¬Ø°Ø¹ ÙˆØ§Ù„Ø£Ø·Ø±Ø§Ù",
            a5: "ØªØ­Øª Ø§Ù„Ø£Ø¸Ø§ÙØ±",
            treatments: "Ø§Ù„Ø¹Ù„Ø§Ø¬",
            video_src: "{{ url_for('static', filename='Pics/video_ringworm_ar.mp4') }}" 
        },
        en: {
            history: "History",
            community: "Community",
            about: "About",
            profile: "Profile", 
            login: "Log In", 
            logout: "Log Out", 
            youhave: "You Have a {percentage}<br>Chance that you have",
            diesase: "Tinea Ringworm", // ØªØ±Ø¬Ù…Ø© Ringworm
            description: "A common fungal infection that appears as a red, itchy, and scaly rash in a ring shape. Despite its name, it is not caused by a worm.",
            Symptoms: "Symptoms",
            s1: "Circular or ring-shaped rash",
            s2: "Raised and scaly edges",
            s3: "Itching in the affected area",
            s4: "Peeling or cracking skin",
            s5: "Red and irritated skin",
            picalt1: "Common areas where Ringworm appears",
            picalt2: "Visual examples of Ringworm symptoms",
            appears: "It can appears in:",
            a1: "Scalp (Tinea Capitis)",
            a2: "Feet (Athlete's Foot)",
            a3: "Groin (Jock Itch)",
            a4: "Trunk and limbs",
            a5: "Under the nails",
            treatments: "Treatments",
            video_src: "{{ url_for('static', filename='Pics/video_ringworm_en.mp4') }}"
        }
    };

    //  Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„/ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬)
    function updateAuthLink(lang) {
        const authLink = document.getElementById('authLink');
        const isLoggedIn = localStorage.getItem('loggedIn') === 'true' && localStorage.getItem('token');

        if (!authLink) return;

        if (isLoggedIn) {
            authLink.textContent = translations[lang]['logout'];
            authLink.setAttribute('onclick', 'logout()');
            authLink.removeAttribute('href');
        } else {
            authLink.textContent = translations[lang]['login'];
            authLink.setAttribute('href', '{{ url_for('login') }}');
            authLink.removeAttribute('onclick');
        }
    }


    function switchLang(lang) {
        document.documentElement.lang = lang;
        document.documentElement.dir = lang === "ar" ? "rtl" : "ltr";

        // ğŸ’¡ [Ù…ÙØªØ§Ø­ Ø§Ù„Ø­Ù„]: Ù†Ø­ÙØ¸ Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© (Ø§Ù„ØªÙŠ ÙˆØ¶Ø¹Ù‡Ø§ Jinja2) Ù‚Ø¨Ù„ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„
        const currentPercentage = document.querySelector('.percentage').textContent;

        document.querySelectorAll("[data-key]").forEach(el => {
            const key = el.dataset.key;
            let text = translations[lang][key];

            // Ù…Ù†Ø·Ù‚ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
            if (key === 'video_src') {
                const videoElement = document.getElementById('video');
                if (videoElement && text) {
                    videoElement.src = text;
                    videoElement.load();
                    videoElement.play(); 
                }
                return;
            }
            
            if (el.tagName === "INPUT" || el.tagName === "TEXTAREA") {
                el.placeholder = text;
            } else if (key === 'youhave') {
                // ğŸ’¡ Ø¯Ù…Ø¬ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙÙŠ Ù†Øµ Ø§Ù„ØªØ±Ø¬Ù…Ø©
                text = text.replace('{percentage}', `<span class="percentage">${currentPercentage}</span>`);
                el.innerHTML = text;
            } else if (text) {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªÙŠ Ù„Ù‡Ø§ data-key
                const icon = el.querySelector('i');
                if (icon) {
                    el.innerHTML = '';
                    el.appendChild(icon);
                    el.appendChild(document.createTextNode(' ' + text));
                } else {
                    el.innerHTML = text;
                }
            }
        });
        
        // ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø¨Ø¹Ø¯ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„ØºØ©
        updateAuthLink(lang);

        // save the chosen lang in localStorage
        localStorage.setItem("lang", lang);
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Image click to show larger version
        const images = document.querySelectorAll('.image-card img');
        images.forEach(img => {
            img.addEventListener('click', function() {
                const overlay = document.createElement('div');
                overlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.8);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 1000;
                    cursor: pointer;
                `;

                const largeImg = document.createElement('img');
                largeImg.src = this.src;
                largeImg.style.cssText = `
                    max-width: 90%;
                    max-height: 90%;
                    border-radius: 10px;
                `;

                overlay.appendChild(largeImg);
                document.body.appendChild(overlay);

                overlay.addEventListener('click', () => {
                    document.body.removeChild(overlay);
                });
            });
        });

        // Add fade-in animation to cards
        const cards = document.querySelectorAll('.illness-card');
        cards.forEach((card, index) => {
            setTimeout(() => {
                card.classList.add('fade-in');
            }, index * 200);
        });

        //  ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„ØºØ© ÙˆÙ…Ù†Ø·Ù‚ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯
        const savedLang = localStorage.getItem("lang") || "en";
        switchLang(savedLang);

        const profileToggle = document.getElementById('profile-toggle');
        const profileLink = document.getElementById('profileLink');

        // Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚ Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
        if (profileLink) {
            profileLink.addEventListener('click', function(event) {
                const isLoggedIn = localStorage.getItem('loggedIn') === 'true' && localStorage.getItem('token');
                const currentLang = localStorage.getItem('lang') || 'en';

                if (!isLoggedIn) {
                    event.preventDefault(); // Ù…Ù†Ø¹ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
                    alert(currentLang === 'ar' ? "ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ." : "You must log in to view the profile.");
                    window.location.href = "{{ url_for('login') }}"; // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                } else {
                    window.location.href = "{{ url_for('profile') }}";
                }
                if (profileToggle) profileToggle.classList.remove('active');
            });
        }


        if (profileToggle) {
            profileToggle.addEventListener('click', function(event) {
                // Ù…Ù†Ø¹ Ø§Ù„ØªÙ†Ù‚Ù„ Ø¥Ø°Ø§ ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                if (event.target.tagName !== 'A' || event.target.id === 'profileDropdownToggle') {
                    event.preventDefault();
                }
                this.classList.toggle('active');
            });

            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
            document.addEventListener('click', (event) => {
                if (!profileToggle.contains(event.target)) {
                    profileToggle.classList.remove('active');
                }
            });
        }
    });
</script>

</html>